/*
// Azure Resource Manager Template Snippets 
*/
"App Service Plan (Server Farm)": {
  "prefix": "arm-plan",
  "body": [
    "{",
    "    \"apiVersion\": \"2014-06-01\",",
    "    \"name\": \"${AppServicePlan1}\",",
    "    \"type\": \"Microsoft.Web/serverfarms\",",
    "    \"location\": \"[resourceGroup().location]\",",
    "    \"sku\": {",
    "        \"name\": \"F1\","
    "        \"capacity\": 1",
    "    },",
    "    \"tags\": {",
    "        \"displayName\": \"${AppServicePlan1}\"",
    "    },",
    "    \"properties\": {",
    "        \"name\": \"${AppServicePlan1}\"",
    "    }",
    "}"
  ],
  "description": "App Service Plan (Server Farm)"
},
"Application Insights for Web Apps": {
  "prefix": "arm-ai",
  "body": [
    "{",
    "    \"name\": \"${AppInsights1}-${APP_SERVICE_PLAN_NAME}-AutoScaleSettings\",",
    "    \"type\": \"Microsoft.Insights/autoscalesettings\",",
    "    \"apiVersion\": \"2014-04-01\",",
    "    \"location\": \"East US\",",
    "    \"tags\": {",
    "        \"[concat('hidden-link:', resourceGroup().id, '/providers/Microsoft.Web/serverfarms/${APP_SERVICE_PLAN_NAME}')]\": \"Resource\",",
    "        \"displayName\": \"${AppInsights1} AutoScale Settings for ${APP_SERVICE_PLAN_NAME}\"",
    "    },",
    "    \"dependsOn\": [",
    "        \"Microsoft.Web/serverfarms/${APP_SERVICE_PLAN_NAME}\"",
    "    ],",
    "    \"properties\": {",
    "        \"name\": \"${AppInsights1}-${APP_SERVICE_PLAN_NAME}-AutoScaleSettings\",",
    "        \"profiles\": [",
    "            {",
    "                \"name\": \"Default\",",
    "                \"capacity\": {",
    "                    \"minimum\": 1,",
    "                    \"maximum\": 2,",
    "                    \"default\": 1",
    "                },",
    "                \"rules\": [",
    "                    {",
    "                        \"metricTrigger\": {",
    "                            \"metricName\": \"CpuPercentage\",",
    "                            \"metricResourceUri\": \"[concat(resourceGroup().id, '/providers/Microsoft.Web/serverfarms/${APP_SERVICE_PLAN_NAME}')]\",",
    "                            \"timeGrain\": \"PT1M\",",
    "                            \"statistic\": \"Average\",",
    "                            \"timeWindow\": \"PT10M\",",
    "                            \"timeAggregation\": \"Average\",",
    "                            \"operator\": \"GreaterThan\",",
    "                            \"threshold\": 80.0",
    "                        },",
    "                        \"scaleAction\": {",
    "                            \"direction\": \"Increase\",",
    "                            \"type\": \"ChangeCount\",",
    "                            \"value\": 1,",
    "                            \"cooldown\": \"PT10M\"",
    "                        }",
    "                    },",
    "                    {",
    "                        \"metricTrigger\": {",
    "                            \"metricName\": \"CpuPercentage\",",
    "                            \"metricResourceUri\": \"[concat(resourceGroup().id, '/providers/Microsoft.Web/serverfarms/${APP_SERVICE_PLAN_NAME}')]\",",
    "                            \"timeGrain\": \"PT1M\",",
    "                            \"statistic\": \"Average\",",
    "                            \"timeWindow\": \"PT1H\",",
    "                            \"timeAggregation\": \"Average\",",
    "                            \"operator\": \"LessThan\",",
    "                            \"threshold\": 60.0",
    "                        },",
    "                        \"scaleAction\": {",
    "                            \"direction\": \"Decrease\",",
    "                            \"type\": \"ChangeCount\",",
    "                            \"value\": 1,",
    "                            \"cooldown\": \"PT1H\"",
    "                        }",
    "                    }",
    "                ]",
    "            }",
    "        ],",
    "        \"enabled\": false,",
    "        \"targetResourceUri\": \"[concat(resourceGroup().id, '/providers/Microsoft.Web/serverfarms/${APP_SERVICE_PLAN_NAME}')]\"",
    "    }",
    "},",
    "{",
    "    \"apiVersion\": \"2014-04-01\",",
    "    \"name\": \"${AppInsights1}-CPUHigh-${APP_SERVICE_PLAN_NAME}\",",
    "    \"type\": \"Microsoft.Insights/alertrules\",",
    "    \"location\": \"East US\",",
    "    \"tags\": {",
    "        \"[concat('hidden-link:', resourceGroup().id, '/providers/Microsoft.Web/serverfarms/${APP_SERVICE_PLAN_NAME}')]\": \"Resource\",",
    "        \"displayName\": \"${AppInsights1} CPUHigh rule for ${APP_SERVICE_PLAN_NAME}\"",
    "    },",
    "    \"dependsOn\": [",
    "        \"Microsoft.Web/serverfarms/${APP_SERVICE_PLAN_NAME}\"",
    "    ],",
    "    \"properties\": {",
    "        \"name\": \"${AppInsights1}-CPUHigh-${APP_SERVICE_PLAN_NAME}\",",
    "        \"description\": \"The average CPU is high across all the instances of ${APP_SERVICE_PLAN_NAME}\",",
    "        \"isEnabled\": false,",
    "        \"condition\": {",
    "            \"odata.type\": \"Microsoft.Azure.Management.Insights.Models.ThresholdRuleCondition\",",
    "            \"dataSource\": {",
    "                \"odata.type\": \"Microsoft.Azure.Management.Insights.Models.RuleMetricDataSource\",",
    "                \"resourceUri\": \"[concat(resourceGroup().id, '/providers/Microsoft.Web/serverfarms/${APP_SERVICE_PLAN_NAME}')]\",",
    "                \"metricName\": \"CpuPercentage\"",
    "            },",
    "            \"operator\": \"GreaterThan\",",
    "            \"threshold\": 90,",
    "            \"windowSize\": \"PT15M\"",
    "        },",
    "        \"action\": {",
    "            \"odata.type\": \"Microsoft.Azure.Management.Insights.Models.RuleEmailAction\",",
    "            \"sendToServiceOwners\": true,",
    "            \"customEmails\": []",
    "        }",
    "    }",
    "},",
    "{",
    "    \"apiVersion\": \"2014-04-01\",",
    "    \"name\": \"${AppInsights1}-LongHttpQueue-${APP_SERVICE_PLAN_NAME}\",",
    "    \"type\": \"Microsoft.Insights/alertrules\",",
    "    \"location\": \"East US\",",
    "    \"tags\": {",
    "        \"[concat('hidden-link:', resourceGroup().id, '/providers/Microsoft.Web/serverfarms/${APP_SERVICE_PLAN_NAME}')]\": \"Resource\",",
    "        \"displayName\": \"${AppInsights1} LongHttpQueue rule for ${APP_SERVICE_PLAN_NAME}\"",
    "    },",
    "    \"dependsOn\": [",
    "        \"Microsoft.Web/serverfarms/${APP_SERVICE_PLAN_NAME}\"",
    "    ],",
    "    \"properties\": {",
    "        \"name\": \"${AppInsights1}-LongHttpQueue-${APP_SERVICE_PLAN_NAME}\",",
    "        \"description\": \"The HTTP queue for the instances of ${APP_SERVICE_PLAN_NAME} has a large number of pending requests.\",",
    "        \"isEnabled\": false,",
    "        \"condition\": {",
    "            \"odata.type\": \"Microsoft.Azure.Management.Insights.Models.ThresholdRuleCondition\",",
    "            \"dataSource\": {",
    "                \"odata.type\": \"Microsoft.Azure.Management.Insights.Models.RuleMetricDataSource\",",
    "                \"resourceUri\": \"[concat(resourceGroup().id, '/providers/Microsoft.Web/serverfarms/${APP_SERVICE_PLAN_NAME}')]\",",
    "                \"metricName\": \"HttpQueueLength\"",
    "            },",
    "            \"operator\": \"GreaterThan\",",
    "            \"threshold\": 100.0,",
    "            \"windowSize\": \"PT5M\"",
    "        },",
    "        \"action\": {",
    "            \"odata.type\": \"Microsoft.Azure.Management.Insights.Models.RuleEmailAction\",",
    "            \"sendToServiceOwners\": true,",
    "            \"customEmails\": []",
    "        }",
    "    }",
    "},",
    "{",
    "    \"apiVersion\": \"2014-04-01\",",
    "    \"name\": \"${AppInsights1}-ServerErrors-${WEB_APP_NAME}\",",
    "    \"type\": \"Microsoft.Insights/alertrules\",",
    "    \"location\": \"East US\",",
    "    \"tags\": {",
    "        \"[concat('hidden-link:', resourceGroup().id, '/providers/Microsoft.Web/sites/${WEB_APP_NAME}')]\": \"Resource\",",
    "        \"displayName\": \"${AppInsights1} ServerErrors rule for ${WEB_APP_NAME}\"",
    "    },",
    "    \"dependsOn\": [",
    "        \"Microsoft.Web/sites/${WEB_APP_NAME}\"",
    "    ],",
    "    \"properties\": {",
    "        \"name\": \"${AppInsights1}-ServerErrors-${WEB_APP_NAME}\",",
    "        \"description\": \"${WEB_APP_NAME} has some server errors, status code 5xx.\",",
    "        \"isEnabled\": false,",
    "        \"condition\": {",
    "            \"odata.type\": \"Microsoft.Azure.Management.Insights.Models.ThresholdRuleCondition\",",
    "            \"dataSource\": {",
    "                \"odata.type\": \"Microsoft.Azure.Management.Insights.Models.RuleMetricDataSource\",",
    "                \"resourceUri\": \"[concat(resourceGroup().id, '/providers/Microsoft.Web/sites/${WEB_APP_NAME}')]\",",
    "                \"metricName\": \"Http5xx\"",
    "            },",
    "            \"operator\": \"GreaterThan\",",
    "            \"threshold\": 0.0,",
    "            \"windowSize\": \"PT5M\"",
    "        },",
    "        \"action\": {",
    "            \"odata.type\": \"Microsoft.Azure.Management.Insights.Models.RuleEmailAction\",",
    "            \"sendToServiceOwners\": true,",
    "            \"customEmails\": []",
    "        }",
    "    }",
    "},",
    "{",
    "    \"apiVersion\": \"2014-04-01\",",
    "    \"name\": \"${AppInsights1}-ForbiddenRequests-${WEB_APP_NAME}\",",
    "    \"type\": \"Microsoft.Insights/alertrules\",",
    "    \"location\": \"East US\",",
    "    \"tags\": {",
    "        \"displayName\": \"${AppInsights1} ForbiddenRequests rule for ${WEB_APP_NAME}\"",
    "    },",
    "    \"dependsOn\": [",
    "        \"Microsoft.Web/sites/${WEB_APP_NAME}\"",
    "    ],",
    "    \"properties\": {",
    "        \"name\": \"${AppInsights1}-ForbiddenRequests-${WEB_APP_NAME}\",",
    "        \"description\": \"${WEB_APP_NAME} has some requests that are forbidden, status code 403.\",",
    "        \"isEnabled\": false,",
    "        \"condition\": {",
    "            \"odata.type\": \"Microsoft.Azure.Management.Insights.Models.ThresholdRuleCondition\",",
    "            \"dataSource\": {",
    "                \"odata.type\": \"Microsoft.Azure.Management.Insights.Models.RuleMetricDataSource\",",
    "                \"resourceUri\": \"[concat(resourceGroup().id, '/providers/Microsoft.Web/sites/${WEB_APP_NAME}')]\",",
    "                \"metricName\": \"Http403\"",
    "            },",
    "            \"operator\": \"GreaterThan\",",
    "            \"threshold\": 0,",
    "            \"windowSize\": \"PT5M\"",
    "        },",
    "        \"action\": {",
    "            \"odata.type\": \"Microsoft.Azure.Management.Insights.Models.RuleEmailAction\",",
    "            \"sendToServiceOwners\": true,",
    "            \"customEmails\": []",
    "        }",
    "    }",
    "},",
    "{",
    "    \"apiVersion\": \"2014-04-01\",",
    "    \"name\": \"${AppInsights1}\",",
    "    \"type\": \"Microsoft.Insights/components\",",
    "    \"location\": \"Central US\",",
    "    \"tags\": {",
    "        \"displayName\": \"${AppInsights1} Component for ${WEB_APP_NAME}\"",
    "    },",
    "    \"dependsOn\": [",
    "        \"Microsoft.Web/sites/${WEB_APP_NAME}\"",
    "    ],",
    "    \"properties\": {",
    "        \"applicationId\": \"${WEB_APP_NAME}\"",
    "    }",
    "}"
  ],
  "description": "Application Insights for Web Apps"
},
"Availability Set": {
  "prefix": "arm-avail",
  "body": [
    "{",
    "    \"type\": \"Microsoft.Compute/availabilitySets\",",
    "    \"name\": \"${AvailabilitySet1}\",",
    "    \"apiVersion\": \"2015-06-15\",",
    "    \"location\": \"[resourceGroup().location]\",",
    "    \"tags\": {",
    "        \"displayName\": \"${AvailabilitySet1}\"",
    "    },",
    "    \"properties\": {}",
    "}"
  ],
  "description": "Availability Set"
},
"Custom Script for Linux Extension": {
  "prefix": "arm-script-linux",
  "body": [
    "{",
    "    \"type\": \"extensions\",",
    "    \"name\": \"${CustomScript1}\",",
    "    \"apiVersion\": \"2015-06-15\",",
    "    \"location\": \"[resourceGroup().location]\",",
    "    \"tags\": {",
    "        \"displayName\": \"${CustomScript1} for Linux VM\"",
    "    },",
    "    \"dependsOn\": [",
    "        \"Microsoft.Compute/virtualMachines/${UbuntuVM1}\"",
    "    ],",
    "    \"properties\": {",
    "        \"publisher\": \"Microsoft.OSTCExtensions\",",
    "        \"type\": \"CustomScriptForLinux\",",
    "        \"typeHandlerVersion\": \"1.4\",",
    "        \"autoUpgradeMinorVersion\": true,",
    "        \"settings\": {",
    "            \"fileUris\": [",
    "                \"[concat(parameters('_artifactsLocation'), '/${Scripts}/${CustomScript.sh}', parameters('_artifactsLocationSasToken'))]\"",
    "            ],",
    "            \"commandToExecute\": \"sh ${CustomScript.sh}\"",
    "        }",
    "    }",
    "}"
  ],
  "description": "Custom Script for Linux Extension"
},
"Custom Script for Windows Extension": {
  "prefix": "arm-script-windows",
  "body": [
    "{",
    "    \"type\": \"extensions\",",
    "    \"name\": \"${CustomScript1}\",",
    "    \"apiVersion\": \"2015-06-15\",",
    "    \"location\": \"[resourceGroup().location]\",",
    "    \"tags\": {",
    "        \"displayName\": \"${CustomScript1} for Windows VM\"",
    "    },",
    "    \"dependsOn\": [",
    "        \"Microsoft.Compute/virtualMachines/${WindowsVM1}\"",
    "    ],",
    "    \"properties\": {",
    "        \"publisher\": \"Microsoft.Compute\",",
    "        \"type\": \"CustomScriptExtension\",",
    "        \"typeHandlerVersion\": \"1.4\",",
    "        \"autoUpgradeMinorVersion\": true,",
    "        \"settings\": {",
    "            \"fileUris\": [",
    "                \"[concat(parameters('_artifactsLocation'), '/${Scripts}/${CustomScript.ps1}', parameters('_artifactsLocationSasToken'))]\"",
    "            ],",
    "            \"commandToExecute\": \"powershell -ExecutionPolicy Bypass -file ${CustomScript.ps1}\"",
    "        }",
    "    }",
    "}"
  ],
  "description": "Custom Script for Windows Extension"
},
"MySQL Database": {
  "prefix": "arm-mysql",
  "body": [
    "{",
    "    \"apiVersion\": \"2014-04-01\",",
    "    \"tags\": {",
    "        \"provision_source\": \"RMS\",",
    "        \"displayName\": \"${MySQLdb1}\"",
    "    },",
    "    \"plan\": {",
    "        \"name\": \"${Free}\"",
    "    },",
    "    \"name\": \"${MySQLdb1}\",",
    "    \"type\": \"SuccessBricks.ClearDB/databases\",",
    "    \"location\": \"[resourceGroup().location]\"",
    "}"
  ],
  "description": "MySQL Database"
},
"Nested Deployment": {
  "prefix": "arm-nest",
  "body": [
    "{",
    "    \"name\": \"${NestedDeployment1}\",",
    "    \"type\": \"Microsoft.Resources/deployments\",",
    "    \"apiVersion\": \"2015-01-01\",",
    "    \"tags\": {",
    "        \"displayName\": \"${NestedDeployment1}\",",
    "    }",
    "    \"properties\": {",
    "        \"mode\": \"Incremental\",",
    "        \"templateLink\": {",
    "            \"uri\": \"[concat(parameters('_artifactsLocation'), '/${NestedTemplates}/${NestedTemplate.json}', parameters('_artifactsLocationSasToken'))]\",",
    "            \"contentVersion\": \"1.0.0.0\"",
    "        },",
    "        \"parameters\": {}",
    "    }",
    "}"
  ],
  "description": "Nested Deployment"
},
"Network Interface": {
  "prefix": "arm-nic",
  "body": [
    "{",
    "    \"apiVersion\": \"2015-06-15\",",
    "    \"type\": \"Microsoft.Network/networkInterfaces\",",
    "    \"name\": \"${NetworkInterface1}\",",
    "    \"location\": \"[resourceGroup().location]\",",
    "    \"tags\": {",
    "        \"displayName\": \"${NetworkInterface1}\"",
    "    },",
    "    \"dependsOn\": [",
    "        \"Microsoft.Network/virtualNetworks/${VirtualNetwork1}\"",
    "    ],",
    "    \"properties\": {",
    "        \"ipConfigurations\": [",
    "            {",
    "                \"name\": \"ipconfig1\",",
    "                \"properties\": {",
    "                    \"privateIPAllocationMethod\": \"Dynamic\",",
    "                    \"subnet\": {",
    "                        \"id\": \"[concat([resourceId('Microsoft.Network/virtualNetworks', '${VirtualNetwork1}')], '/subnets/${VirtualNetwork1-Subnet}')]\"",
    "                    }",
    "                }",
    "            }",
    "        ]",
    "    }",
    "}"
  ],
  "description": "Network Interface"
},
"PowerShell DSC Extension": {
  "prefix": "arm-dsc",
  "body": [
    "{",
    "    \"type\": \"extensions\",",
    "    \"name\": \"${DSCScript1}\",",
    "    \"apiVersion\": \"2015-05-06\",",
    "    \"location\": \"[resourceGroup().location]\",",
    "    \"tags\": {",
    "        \"displayName\": \"${DSCScript1}\"",
    "    },",
    "    \"dependsOn\": [",
    "        \"Microsoft.Compute/virtualMachines/${VM_NAME}\"",
    "    ],",
    "    \"properties\": {",
    "        \"publisher\": \"Microsoft.Powershell\",",
    "        \"type\": \"DSC\",",
    "        \"typeHandlerVersion\": \"2.9\",",
    "        \"autoUpgradeMinorVersion\": true,",
    "        \"settings\": {",
    "            \"modulesUrl\": \"[concat(parameters('_artifactsLocation'), '/${dsc.zip}')]\",",
    "            \"sasToken\": \"[parameters('_artifactsLocationSasToken')]\",",
    "            \"configurationFunction\": \"${CONFIGURATION_FUNCTION}\",",
    "            \"properties\": {",
    "                \"nodeName\": \"${VM_NAME}\"",
    "            }",
    "        },",
    "        \"protectedSettings\": {}",
    "    }",
    "}"
  ],
  "description": "PowerShell DSC Extension"
},
"Public IP Address": {
  "prefix": "arm-ip",
  "body": [
    "{",
    "    \"apiVersion\": \"2015-06-15\",",
    "    \"type\": \"Microsoft.Network/publicIPAddresses\",",
    "    \"name\": \"${IPAddress1}\",",
    "    \"location\": \"[resourceGroup().location]\",",
    "    \"tags\": {",
    "        \"displayName\": \"${IPAddress1}\"",
    "    },",
    "    \"properties\": {",
    "        \"publicIPAllocationMethod\": \"Dynamic\",",
    "        \"dnsSettings\": {",
    "            \"domainNameLabel\": \"${DNS_NAME}\"",
    "        }",
    "    }",
    "}"
  ],
  "description": "Public IP Address"
},
"Redis Cache": {
  "prefix": "arm-redis",
  "body": [
    "{",
    "    \"apiVersion\": \"2014-04-01-preview\",",
    "    \"name\": \"${RedisCache1}\",",
    "    \"type\": \"Microsoft.Cache/Redis\",",
    "    \"location\": \"[resourceGroup().location]\",",
    "    \"tags\": {",
    "        \"displayName\": \"${RedisCache1}\"",
    "    },",
    "    \"properties\": {",
    "        \"sku\": {",
    "            \"name\": \"${Basic}\",",
    "            \"family\": \"${C}\",",
    "            \"capacity\": \"${0}\"",
    "        },",
    "        \"redisVersion\": \"${2.8}\"",
    "    }",
    "}"
  ],
  "description": "Redis Cache"
},
"SQL Database": {
  "prefix": "arm-sqldb",
  "body": [
    "{",
    "    \"type\": \"databases\",",
    "    \"name\": \"${SQLdb1}\",",
    "    \"apiVersion\": \"2014-04-01-preview\",",
    "    \"location\": \"[resourceGroup().location]\",",
    "    \"tags\": {",
    "        \"displayName\": \"${SQLdb1}\"",
    "    },",
    "    \"dependsOn\": [",
    "        \"${SERVER_NAME}\"",
    "    ],",
    "    \"properties\": {",
    "        \"collation\": \"${SQL_Latin1_General_CP1_CI_AS}\",",
    "        \"edition\": \"${Basic}\",",
    "        \"maxSizeBytes\": \"${1073741824}\"",
    "        \"requestedServiceObjectiveName\": \"${Basic}\",
    "    }",
    "}"
  ],
  "description": "SQL Database"
},
"SQL Database Import": {
  "prefix": "arm-dbimp",
  "body": [
    "{",
    "    \"name\": \"${DATABASE_NAME}Import1\",",
    "    \"type\": \"extensions\",",
    "    \"apiVersion\": \"2014-04-01-preview\",",
    "    \"dependsOn\": [",
    "        \"Microsoft.Sql/servers/${SQL_SERVER_NAME}/databases/${DATABASE_NAME}\"",
    "    ],",
    "    \"tags\": {",
    "        \"displayName\": \"SQL Database Import for ${DATABASE_NAME}\"",
    "    },",
    "    \"properties\": {",
    "        \"storageKeyType\": \"${Primary}\",",
    "        \"storageKey\": \"${STORAGE_KEY}\",",
    "        \"storageUri\": \"${STORAGE_KEY_URI}\",",
    "        \"administratorLogin\": \"${ADMIN_USERNAME}\",",
    "        \"administratorLoginPassword\": \"${ADMIN_PASSWORD}\",",
    "        \"operationMode\": \"Import\"",
    "    }",
    "}"
  ],
  "description": "SQL Database Import"
},
"SQL Server": {
  "prefix": "arm-sqlsvr",
  "body": [
    "{",
    "    \"apiVersion\": \"2014-04-01-preview\",",
    "    \"name\": \"${sqlserver1}\",",
    "    \"type\": \"Microsoft.Sql/servers\",",
    "    \"location\": \"[resourceGroup().location]\",",
    "    \"tags\": {",
    "        \"displayName\": \"${sqlserver1}\"",
    "    },",
    "    \"properties\": {",
    "        \"administratorLogin\": \"${ADMIN_USERNAME}\",",
    "        \"administratorLoginPassword\": \"${ADMIN_PASSWORD}\"",
    "    },",
    "    \"resources\": [",
    "        {",
    "            \"apiVersion\": \"2014-04-01-preview\",",
    "            \"dependsOn\": [",
    "                \"Microsoft.Sql/servers/${sqlserver1}\"",
    "            ],",
    "            \"location\": \"[resourceGroup().location]\",",
    "            \"name\": \"AllowAllWindowsAzureIps\",",
    "            \"properties\": {",
    "                \"startIpAddress\": \"0.0.0.0\",",
    "                \"endIpAddress\": \"0.0.0.0\"",
    "            },",
    "            \"type\": \"firewallrules\"",
    "        }",
    "    ]",
    "}"
  ],
  "description": "SQL Server"
},
"Storage Account": {
  "prefix": "arm-stg",
  "body": [
    "{",
    "    \"type\": \"Microsoft.Storage/storageAccounts\",",
    "    \"name\": \"${StorageAccount1}\",",
    "    \"apiVersion\": \"2015-06-15\",",
    "    \"location\": \"[resourceGroup().location]\",",
    "    \"tags\": {",
    "        \"displayName\": \"${StorageAccount1}\"",
    "    },",
    "    \"properties\": {",
    "        \"accountType\": \"${Standard_LRS}\"",
    "    }",
    "}"
  ],
  "description": "Storage Account"
},
"Ubuntu Virtual Machine": {
  "prefix": "arm-vm-ubuntu",
  "body": [
    "{",
    "    \"type\": \"Microsoft.Storage/storageAccounts\",",
    "    \"name\": \"${UbuntuVM1}storage\",",
    "    \"apiVersion\": \"2015-06-15\",",
    "    \"location\": \"[resourceGroup().location]\",",
    "    \"tags\": {",
    "        \"displayName\": \"${UbuntuVM1} Storage Account\"",
    "    },",
    "    \"properties\": {",
    "        \"accountType\": \"Standard_LRS\"",
    "    }",
    "},",
    "{",
    "    \"apiVersion\": \"2015-06-15\",",
    "    \"type\": \"Microsoft.Network/publicIPAddresses\",",
    "    \"name\": \"${UbuntuVM1}-PublicIP\",",
    "    \"location\": \"[resourceGroup().location]\",",
    "    \"tags\": {",
    "        \"displayName\": \"PublicIPAddress\"",
    "    },",
    "    \"properties\": {",
    "        \"publicIPAllocationMethod\": \"Dynamic\",",
    "        \"dnsSettings\": {",
    "            \"domainNameLabel\": \"${UbuntuVM1}-PublicIP\"",
    "        }",
    "    }",
    "},",
    "{",
    "    \"apiVersion\": \"2015-06-15\",",
    "    \"type\": \"Microsoft.Network/virtualNetworks\",",
    "    \"name\": \"${UbuntuVM1}-VirtualNetwork\",",
    "    \"location\": \"[resourceGroup().location]\",",
    "    \"tags\": {",
    "        \"displayName\": \"VirtualNetwork\"",
    "    },",
    "    \"properties\": {",
    "        \"addressSpace\": {",
    "            \"addressPrefixes\": [",
    "                \"10.0.0.0/16\"",
    "            ]",
    "        },",
    "        \"subnets\": [",
    "            {",
    "                \"name\": \"${UbuntuVM1}-VirtualNetwork-Subnet\",",
    "                \"properties\": {",
    "                    \"addressPrefix\": \"10.0.0.0/24\"",
    "                }",
    "            }",
    "        ]",
    "    }",
    "},",
    "{",
    "    \"apiVersion\": \"2015-06-15\",",
    "    \"type\": \"Microsoft.Network/networkInterfaces\",",
    "    \"name\": \"${UbuntuVM1}-NetworkInterface\",",
    "    \"location\": \"[resourceGroup().location]\",",
    "    \"dependsOn\": [",
    "        \"Microsoft.Network/publicIPAddresses/${UbuntuVM1}-PublicIP\",",
    "        \"Microsoft.Network/virtualNetworks/${UbuntuVM1}-VirtualNetwork\"",
    "    ],",
    "    \"tags\": {",
    "        \"displayName\": \"${UbuntuVM1}-NetworkInterface\"",
    "    },",
    "    \"properties\": {",
    "        \"ipConfigurations\": [",
    "            {",
    "                \"name\": \"ipconfig1\",",
    "                \"properties\": {",
    "                    \"privateIPAllocationMethod\": \"Dynamic\",",
    "                    \"publicIPAddress\": {",
    "                        \"id\": \"[resourceId('Microsoft.Network/publicIPAddresses', '${UbuntuVM1}-VirtualNetwork')]\"",
    "                    },", 
    "                    \"subnet\": {",
    "                        \"id\": \"[concat(resourceId('Microsoft.Network/virtualNetworks', '${UbuntuVM1}-VirtualNetwork'), '/subnets/${UbuntuVM1}-VirtualNetwork-Subnet')]\"",
    "                    }",
    "                }",
    "            }",
    "        ]",
    "    }",
    "},",
    "{",
    "    \"apiVersion\": \"2015-06-15\",",
    "    \"type\": \"Microsoft.Compute/virtualMachines\",",
    "    \"name\": \"${UbuntuVM1}\",",
    "    \"location\": \"[resourceGroup().location]\",",
    "    \"dependsOn\": [",
    "        \"Microsoft.Storage/storageAccounts/${UbuntuVM1}storage\",",
    "        \"Microsoft.Network/networkInterfaces/${UbuntuVM1}-NetworkInterface\"",
    "    ],",
    "    \"tags\": {",
    "        \"displayName\": \"${UbuntuVM1}\"",
    "    },",
    "    \"properties\": {",
    "        \"hardwareProfile\": {",
    "            \"vmSize\": \"Standard_D1\"",
    "        },",
    "        \"osProfile\": {",
    "            \"computerName\": \"${UbuntuVM1}\",",
    "            \"adminUsername\": \"${ADMIN_USERNAME}\",",
    "            \"adminPassword\": \"${ADMIN_PASSWORD}\"",
    "        },",
    "        \"storageProfile\": {",
    "            \"imageReference\": {",
    "                \"publisher\": \"Canonical\",",
    "                \"offer\": \"UbuntuServer\",",
    "                \"sku\": \"${15.04}\",",
    "                \"version\": \"latest\"",
    "            },",
    "            \"osDisk\": {",
    "                \"name\": \"${UbuntuVM1}-OSDisk\",",
    "                \"vhd\": {",
    "                    \"uri\": \"http://${UbuntuVM1}storage.blob.core.windows.net/vhds/${UbuntuVM1}-OSDisk.vhd\"",
    "                },",
    "                \"caching\": \"ReadWrite\",",
    "                \"createOption\": \"FromImage\"",
    "            }",
    "        },",
    "        \"networkProfile\": {",
    "            \"networkInterfaces\": [",
    "                {",
    "                    \"id\": \"[resourceId('Microsoft.Network/networkInterfaces', '${UbuntuVM1}-NetworkInterface')]\"",
    "                }",
    "            ]",
    "        }",
    "    }",
    "}"
  ],
  "description": "Ubuntu Virtual Machine"
},
"Virtual Network": {
  "prefix": "arm-vn",
  "body": [
    "{",
    "    \"apiVersion\": \"2015-06-15\",",
    "    \"type\": \"Microsoft.Network/virtualNetworks\",",
    "    \"name\": \"${VirtualNetwork1}\",",
    "    \"location\": \"[resourceGroup().location]\",",
    "    \"tags\": {",
    "        \"displayName\": \"${VirtualNetwork1}\"",
    "    },",
    "    \"properties\": {",
    "        \"addressSpace\": {",
    "            \"addressPrefixes\": [",
    "                \"10.0.0.0/16\"",
    "            ]",
    "        },",
    "        \"subnets\": [",
    "            {",
    "                \"name\": \"Subnet-1\",",
    "                \"properties\": {",
    "                    \"addressPrefix\": \"10.0.0.0/24\"",
    "                }",
    "            },",
    "            {",
    "                \"name\": \"Subnet-2\",",
    "                \"properties\": {",
    "                    \"addressPrefix\": \"10.0.1.0/24\"",
    "                }",
    "            }",
    "        ]",
    "    }",
    "}"
  ],
  "description": "Virtual Network"
},
"Web App": {
  "prefix": "arm-webapp",
  "body": [
    "{",
    "    \"apiVersion\": \"2015-08-01\",",
    "    \"name\": \"${WEB_APP_NAME}\",",
    "    \"type\": \"Microsoft.Web/sites\",",
    "    \"location\": \"[resourceGroup().location]\",",
    "    \"tags\": {",
    "        \"[concat('hidden-related:', resourceGroup().id, '/providers/Microsoft.Web/serverfarms/${APP_SERVICE_PLAN_NAME}')]\": \"Resource\",",
    "        \"displayName\": \"${WEB_APP_NAME}\"",
    "    },",
    "    \"dependsOn\": [",
    "        \"Microsoft.Web/serverfarms/${APP_SERVICE_PLAN_NAME}\"",
    "    ],",
    "    \"properties\": {",
    "        \"name\": \"${WEB_APP_NAME}\",",
    "        \"serverFarm\": \"[resourceId('Microsoft.Web/serverfarms/', ${APP_SERVICE_PLAN_NAME}]\"",
    "    }",
    "}"
  ],
  "description": "Web App"
},
"Web Deploy for Web Apps": {
  "prefix": "arm-webdeploy",
  "body": [
    "{",
    "    \"apiVersion\": \"2014-06-01\",",
    "    \"name\": \"Deploy-${WEB_APP_NAME}\",",
    "    \"location\": \"[resourceGroup().location]\",",
    "    \"type\": \"extensions\",",
    "    \"dependsOn\": [",
    "        \"Microsoft.Web/sites/${WEB_APP_NAME}\"",
    "    ],",
    "    \"tags\": {",
    "        \"displayName\": \"Web Deploy for ${WEB_APP_NAME}\"",
    "    },",
    "    \"properties\": {",
    "        \"packageUri\": \"[concat(parameters('_artifactsLocation'), '/${WebPackages}/${WEB_APP_NAME}.zip', parameters('_artifactsLocationSasToken'))]\",",
    "        \"dbType\": \"None\",",
    "        \"connectionString\": \"\",",
    "        \"setParameters\": {",
    "            \"IIS Web Application Name\": \"${WEB_APP_NAME}\"",
    "        }",
    "    }",
    "}"
  ],
  "description": "Web Deploy for Web Apps"
},
"Windows Azure Diagnostics Extension": {
  "prefix": "arm-diag",
  "body": [
    "{",
    "    \"type\": \"extensions\",",
    "    \"name\": \"Diagnostics-${VM_NAME}\",",
    "    \"apiVersion\": \"2015-06-15\",",
    "    \"location\": \"[resourceGroup().location]\",",
    "    \"tags\": {",
    "        \"displayName\": \"Windows Azure Diagnostics Extension for ${VM_NAME}\"",
    "    },",
    "    \"dependsOn\": [",
    "        \"Microsoft.Compute/virtualMachines/${VM_NAME}\"",
    "    ],",
    "    \"properties\": {",
    "        \"publisher\": \"Microsoft.Azure.Diagnostics\",",
    "        \"type\": \"IaaSDiagnostics\",",
    "        \"typeHandlerVersion\": \"1.5\",",
    "        \"autoUpgradeMinorVersion\": true,",
    "        \"settings\": {",
    "            \"xmlCfg\": \"[base64(<WadCfg> <DiagnosticMonitorConfiguration overallQuotaInMB=\\\"4096\\\" xmlns=\\\"http: //schemas.microsoft.com/ServiceHosting/2010/10/DiagnosticsConfiguration\\\"> <DiagnosticInfrastructureLogs scheduledTransferLogLevelFilter=\\\"Error\\\"/> <Logs scheduledTransferPeriod=\\\"PT1M\\\" scheduledTransferLogLevelFilter=\\\"Error\\\" /> <Directories scheduledTransferPeriod=\\\"PT1M\\\"> <IISLogs containerName =\\\"wad-iis-logfiles\\\" /> <FailedRequestLogs containerName =\\\"wad-failedrequestlogs\\\" /> </Directories> <WindowsEventLog scheduledTransferPeriod=\\\"PT1M\\\" > <DataSource name=\\\"Application!*\\\" /> </WindowsEventLog> <CrashDumps containerName=\\\"wad-crashdumps\\\" dumpType=\\\"Mini\\\"> <CrashDumpConfiguration processName=\\\"WaIISHost.exe\\\"/> <CrashDumpConfiguration processName=\\\"WaWorkerHost.exe\\\"/> <CrashDumpConfiguration processName=\\\"w3wp.exe\\\"/> </CrashDumps> <PerformanceCounters scheduledTransferPeriod=\\\"PT1M\\\"> <PerformanceCounterConfiguration counterSpecifier=\\\"\\Memory\\Available MBytes\\\" sampleRate=\\\"PT3M\\\" /> <PerformanceCounterConfiguration counterSpecifier=\\\"\\Web Service(_Total)\\ISAPI Extension Requests/sec\\\" sampleRate=\\\"PT3M\\\" /> <PerformanceCounterConfiguration counterSpecifier=\\\"\\Web Service(_Total)\\Bytes Total/Sec\\\" sampleRate=\\\"PT3M\\\" /> <PerformanceCounterConfiguration counterSpecifier=\\\"\\ASP.NET Applications(__Total__)\\Requests/Sec\\\" sampleRate=\\\"PT3M\\\" /> <PerformanceCounterConfiguration counterSpecifier=\\\"\\ASP.NET Applications(__Total__)\\Errors Total/Sec\\\" sampleRate=\\\"PT3M\\\" /> <PerformanceCounterConfiguration counterSpecifier=\\\"\\ASP.NET\\Requests Queued\\\" sampleRate=\\\"PT3M\\\" /> <PerformanceCounterConfiguration counterSpecifier=\\\"\\ASP.NET\\Requests Rejected\\\" sampleRate=\\\"PT3M\\\" /> <PerformanceCounterConfiguration counterSpecifier=\\\"\\Processor(_Total)\\% Processor Time\\\" sampleRate=\\\"PT3M\\\" /> </PerformanceCounters> </DiagnosticMonitorConfiguration> </WadCfg>)]\",",
    "            \"storageAccount\": \"${DIAGNOSTICS_STORAGE_ACCOUNT}\"",
    "        },",
    "        \"protectedSettings\": {",
    "            \"storageAccountName\": \"${DIAGNOSTICS_STORAGE_ACCOUNT}\",",
    "            \"storageAccountKey\": \"[listkeys([concat('/subscriptions/', subscription().subscriptionId, '/resourceGroups/${DIAGNOSTICS_STORAGE_RESOURCE_GROUP}/providers/Microsoft.Storage/storageAccounts/${DIAGNOSTICS_STORAGE_ACCOUNT}')], '2015-06-15').key1]\",",
    "            \"storageAccountEndPoint\": \"https://core.windows.net\"",
    "        }",
    "    }",
    "}"
  ],
  "description": "Windows Azure Diagnostics Extension"
},
"Windows Virtual Machine": {
  "prefix": "arm-vm-windows",
  "body": [
    "{",
    "    \"type\": \"Microsoft.Storage/storageAccounts\",",
    "    \"name\": \"${WindowsVM1}storage\",",
    "    \"apiVersion\": \"2015-06-15\",",
    "    \"location\": \"[resourceGroup().location]\",",
    "    \"tags\": {",
    "        \"displayName\": \"${WindowsVM1} Storage Account\"",
    "    },",
    "    \"properties\": {",
    "        \"accountType\": \"Standard_LRS\"",
    "    }",
    "},",
    "{",
    "    \"apiVersion\": \"2015-06-15\",",
    "    \"type\": \"Microsoft.Network/publicIPAddresses\",",
    "    \"name\": \"${WindowsVM1}-PublicIP\",",
    "    \"location\": \"[resourceGroup().location]\",",
    "    \"tags\": {",
    "        \"displayName\": \"PublicIPAddress\"",
    "    },",
    "    \"properties\": {",
    "        \"publicIPAllocationMethod\": \"Dynamic\",",
    "        \"dnsSettings\": {",
    "            \"domainNameLabel\": \"${WindowsVM1}-PublicIP\"",
    "        }",
    "    }",
    "},",
    "{",
    "    \"apiVersion\": \"2015-06-15\",",
    "    \"type\": \"Microsoft.Network/virtualNetworks\",",
    "    \"name\": \"${WindowsVM1}-VirtualNetwork\",",
    "    \"location\": \"[resourceGroup().location]\",",
    "    \"tags\": {",
    "        \"displayName\": \"VirtualNetwork\"",
    "    },",
    "    \"properties\": {",
    "        \"addressSpace\": {",
    "            \"addressPrefixes\": [",
    "                \"10.0.0.0/16\"",
    "            ]",
    "        },",
    "        \"subnets\": [",
    "            {",
    "                \"name\": \"${WindowsVM1}-VirtualNetwork-Subnet\",",
    "                \"properties\": {",
    "                    \"addressPrefix\": \"10.0.0.0/24\"",
    "                }",
    "            }",
    "        ]",
    "    }",
    "},",
    "{",
    "    \"apiVersion\": \"2015-06-15\",",
    "    \"type\": \"Microsoft.Network/networkInterfaces\",",
    "    \"name\": \"${WindowsVM1}-NetworkInterface\",",
    "    \"location\": \"[resourceGroup().location]\",",
    "    \"dependsOn\": [",
    "        \"Microsoft.Network/publicIPAddresses/${WindowsVM1}-PublicIP\",",
    "        \"Microsoft.Network/virtualNetworks/${WindowsVM1}-VirtualNetwork\"",
    "    ],",
    "    \"tags\": {",
    "        \"displayName\": \"${WindowsVM1} Network Interface\"",
    "    },",
    "    \"properties\": {",
    "        \"ipConfigurations\": [",
    "            {",
    "                \"name\": \"ipconfig1\",",
    "                \"properties\": {",
    "                    \"privateIPAllocationMethod\": \"Dynamic\",",
    "                    \"publicIPAddress\": {",
    "                        \"id\": \"[resourceId('Microsoft.Network/publicIPAddresses', '${WindowsVM1}-PublicIP']\"",
    "                    },",
    "                    \"subnet\": {",
    "                        \"id\": \"[concat([resourceId('Microsoft.Network/virtualNetworks', '${WindowsVM1}-VirtualNetwork')], '/subnets/${WindowsVM1}-VirtualNetwork-Subnet')]\"",
    "                    }",
    "                }",
    "            }",
    "        ]",
    "    }",
    "},",
    "{",
    "    \"apiVersion\": \"2015-06-15\",",
    "    \"type\": \"Microsoft.Compute/virtualMachines\",",
    "    \"name\": \"${WindowsVM1}\",",
    "    \"location\": \"[resourceGroup().location]\",",
    "    \"dependsOn\": [",
    "        \"Microsoft.Storage/storageAccounts/${WindowsVM1}storage\",",
    "        \"Microsoft.Network/networkInterfaces/${WindowsVM1}-NetworkInterface\"",
    "    ],",
    "    \"tags\": {",
    "        \"displayName\": \"${WindowsVM1}\"",
    "    },",
    "    \"properties\": {",
    "        \"hardwareProfile\": {",
    "            \"vmSize\": \"Standard_A2\"",
    "        },",
    "        \"osProfile\": {",
    "            \"computerName\": \"${WindowsVM1}\",",
    "            \"adminUsername\": \"${ADMIN_USERNAME}\",",
    "            \"adminPassword\": \"${ADMIN_PASSWORD}\"",
    "        },",
    "        \"storageProfile\": {",
    "            \"imageReference\": {",
    "                \"publisher\": \"MicrosoftWindowsServer\",",
    "                \"offer\": \"WindowsServer\",",
    "                \"sku\": \"${2012-R2-Datacenter}\",",
    "                \"version\": \"latest\"",
    "            },",
    "            \"osDisk\": {",
    "                \"name\": \"${WindowsVM1}OSDisk\",",
    "                \"vhd\": {",
    "                    \"uri\": \"http://${WindowsVM1}storage.blob.core.windows.net/vhds/${WindowsVM1}-OSDisk.vhd\"",
    "                },",
    "                \"caching\": \"ReadWrite\",",
    "                \"createOption\": \"FromImage\"",
    "            }",
    "        },",
    "        \"networkProfile\": {",
    "            \"networkInterfaces\": [",
    "                {",
    "                    \"id\": \"[resourceId('Microsoft.Network/networkInterfaces', '${WindowsVM1}-NetworkInterface')]\"",
    "                }",
    "            ]",
    "        },",
    "        \"diagnosticsProfile\": {",
    "            \"bootDiagnostics\": {",
    "                \"enabled\": true,",
    "                \"storageUri\": \"http://${WindowsVM1}storage.blob.core.windows.net')]"
    "            }",
    "        }",
    "    },",
    "    \"resources\": [",
    "        {",
    "            \"type\": \"extensions\",",
    "            \"name\": \"Microsoft.Insights.VMDiagnosticsSettings\",",
    "            \"apiVersion\": \"2015-06-15\",",
    "            \"location\": \"[resourceGroup().location]\",",
    "            \"tags\": {",
    "                \"displayName\": \"AzureDiagnostics\"",
    "            },"
    "            \"dependsOn\": [",
    "                \"Microsoft.Compute/virtualMachines/${WindowsVM1}\"",
    "            ],",
    "            \"properties\": {",
    "                \"publisher\": \"Microsoft.Azure.Diagnostics\",",
    "                \"type\": \"IaaSDiagnostics\",",
    "                \"typeHandlerVersion\": \"1.5\",",
    "                \"autoUpgradeMinorVersion\": true,",
    "                \"settings\": {",
    "                    \"xmlCfg\": \"[base64(<WadCfg> <DiagnosticMonitorConfiguration overallQuotaInMB=\\\"4096\\\" xmlns=\\\"http: //schemas.microsoft.com/ServiceHosting/2010/10/DiagnosticsConfiguration\\\"> <DiagnosticInfrastructureLogs scheduledTransferLogLevelFilter=\\\"Error\\\"/> <Logs scheduledTransferPeriod=\\\"PT1M\\\" scheduledTransferLogLevelFilter=\\\"Error\\\" /> <Directories scheduledTransferPeriod=\\\"PT1M\\\"> <IISLogs containerName =\\\"wad-iis-logfiles\\\" /> <FailedRequestLogs containerName =\\\"wad-failedrequestlogs\\\" /> </Directories> <WindowsEventLog scheduledTransferPeriod=\\\"PT1M\\\" > <DataSource name=\\\"Application!*\\\" /> </WindowsEventLog> <CrashDumps containerName=\\\"wad-crashdumps\\\" dumpType=\\\"Mini\\\"> <CrashDumpConfiguration processName=\\\"WaIISHost.exe\\\"/> <CrashDumpConfiguration processName=\\\"WaWorkerHost.exe\\\"/> <CrashDumpConfiguration processName=\\\"w3wp.exe\\\"/> </CrashDumps> <PerformanceCounters scheduledTransferPeriod=\\\"PT1M\\\"> <PerformanceCounterConfiguration counterSpecifier=\\\"\\Memory\\Available MBytes\\\" sampleRate=\\\"PT3M\\\" /> <PerformanceCounterConfiguration counterSpecifier=\\\"\\Web Service(_Total)\\ISAPI Extension Requests/sec\\\" sampleRate=\\\"PT3M\\\" /> <PerformanceCounterConfiguration counterSpecifier=\\\"\\Web Service(_Total)\\Bytes Total/Sec\\\" sampleRate=\\\"PT3M\\\" /> <PerformanceCounterConfiguration counterSpecifier=\\\"\\ASP.NET Applications(__Total__)\\Requests/Sec\\\" sampleRate=\\\"PT3M\\\" /> <PerformanceCounterConfiguration counterSpecifier=\\\"\\ASP.NET Applications(__Total__)\\Errors Total/Sec\\\" sampleRate=\\\"PT3M\\\" /> <PerformanceCounterConfiguration counterSpecifier=\\\"\\ASP.NET\\Requests Queued\\\" sampleRate=\\\"PT3M\\\" /> <PerformanceCounterConfiguration counterSpecifier=\\\"\\ASP.NET\\Requests Rejected\\\" sampleRate=\\\"PT3M\\\" /> <PerformanceCounterConfiguration counterSpecifier=\\\"\\Processor(_Total)\\% Processor Time\\\" sampleRate=\\\"PT3M\\\" /> </PerformanceCounters> </DiagnosticMonitorConfiguration> </WadCfg>)]\",",
    "                    \"storageAccount\": \"${WindowsVM1}storage\"",
    "                },",
    "                \"protectedSettings\": {",
    "                    \"storageAccountName\": \"${WindowsVM1}storage\",",
    "                    \"storageAccountKey\": \"[listkeys([concat('/subscriptions/', subscription().subscriptionId, '/resourceGroups/${DIAGNOSTICS_STORAGE_RESOURCE_GROUP}/providers/Microsoft.Storage/storageAccounts/${WindowsVM1}storage')], '2015-06-15').key1]\",",
    "                    \"storageAccountEndPoint\": \"https://core.windows.net\"",
    "                }",
    "            }",
    "        }",
    "    ]",
    "}"
  ],
  "description": "Windows Virtual Machine"
}